#!/bin/bash

# Coolify Deployment Script
# This script provides the exact commands to deploy your site

echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "       COOLIFY DEPLOYMENT - BENNIEWILLIAMS.COM         "
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# Generate a secure secret key
SECRET_KEY=$(python3 -c "import secrets; import string; chars = string.ascii_letters + string.digits + '!@#%^&*(-_=+)'; print(''.join(secrets.choice(chars) for _ in range(50)))" 2>/dev/null || echo "CHANGE-THIS-TO-A-SECURE-50-CHARACTER-KEY-NOW")

echo "ğŸ“‹ DEPLOYMENT CHECKLIST:"
echo "========================"
echo ""
echo "1ï¸âƒ£  LOGIN TO COOLIFY"
echo "   URL: https://coolify.yourdomain.com"
echo ""
echo "2ï¸âƒ£  CREATE NEW APPLICATION"
echo "   â€¢ Click: + New Resource"
echo "   â€¢ Select: Public Repository"
echo ""
echo "3ï¸âƒ£  CONFIGURE REPOSITORY"
echo "   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "   â”‚ Repository URL:                                â”‚"
echo "   â”‚ https://github.com/MDsniper/benniewilliams-wagtail â”‚"
echo "   â”‚                                                â”‚"
echo "   â”‚ Branch: main                                   â”‚"
echo "   â”‚ Build Pack: Dockerfile                         â”‚"
echo "   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""
echo "4ï¸âƒ£  BASIC CONFIGURATION"
echo "   â€¢ Name: benniewilliams"
echo "   â€¢ Port: 8000"
echo ""
echo "5ï¸âƒ£  ENVIRONMENT VARIABLES (Copy exactly):"
echo "   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "   â”‚ Click 'Environment Variables' and add:        â”‚"
echo "   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""
echo "SECRET_KEY=$SECRET_KEY"
echo "DJANGO_SETTINGS_MODULE=benniewilliams.settings.production"
echo "ALLOWED_HOSTS=benniewilliams.com,www.benniewilliams.com,localhost"
echo "DEBUG=False"
echo "SECURE_SSL_REDIRECT=True"
echo "SESSION_COOKIE_SECURE=True"
echo "CSRF_COOKIE_SECURE=True"
echo ""
echo "6ï¸âƒ£  DOMAINS CONFIGURATION"
echo "   â€¢ Add Domain: benniewilliams.com"
echo "   â€¢ Add Domain: www.benniewilliams.com"
echo "   â€¢ âœ… Enable: Generate SSL Certificate"
echo "   â€¢ âœ… Enable: Force HTTPS Redirect"
echo ""
echo "7ï¸âƒ£  HEALTH CHECK"
echo "   â€¢ Health Check Path: /health/"
echo "   â€¢ Health Check Interval: 30"
echo ""
echo "8ï¸âƒ£  RESOURCE LIMITS (Optional)"
echo "   â€¢ CPU: 1"
echo "   â€¢ Memory: 1GB"
echo ""
echo "9ï¸âƒ£  PERSISTENT STORAGE (Recommended)"
echo "   Add Volumes:"
echo "   â€¢ /app/media â†’ volume name: media"
echo "   â€¢ /app/static â†’ volume name: static"
echo ""
echo "ğŸš€ DEPLOY"
echo "   â€¢ Click: Deploy"
echo "   â€¢ Watch logs for: 'Starting gunicorn'"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "â±ï¸  ESTIMATED DEPLOYMENT TIME: 5-10 minutes"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸ“Œ AFTER DEPLOYMENT:"
echo "   1. Visit: https://benniewilliams.com"
echo "   2. Check: /about page for your Gravatar"
echo "   3. Admin: https://benniewilliams.com/admin"
echo ""
echo "ğŸ’¡ TROUBLESHOOTING:"
echo "   â€¢ If deploy fails: Check 'Logs' tab"
echo "   â€¢ If site doesn't load: Verify port is 8000"
echo "   â€¢ If SSL fails: Check domain DNS points to server"
echo ""
echo "Press ENTER to confirm you've copied the above information..."
read -r

echo ""
echo "ğŸ‰ Good luck with your deployment!"
echo "   Repository: https://github.com/MDsniper/benniewilliams-wagtail"
echo "   Support: Check COOLIFY_DEPLOYMENT_GUIDE.md for details"
echo ""